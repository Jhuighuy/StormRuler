<!--
  Copyright (C) 2020-2023 Oleg Butakov
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
-->
<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.9.8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StormRuler: /Users/runner/work/StormRuler/StormRuler/source/Storm/Mallard/MeshUnstructured.hpp Source File</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js">
  </script>
  <script type="text/javascript" src="dynsections.js">
  </script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
  <!--BEGIN DARK_MODE_TOGGLE-->
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js">
  </script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
  </script>
  <!--END DARK_MODE_TOGGLE-->
  <!--BEGIN FRAGMENT_COPY_BUTTON-->
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js">
  </script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
  </script>
  <!--END FRAGMENT_COPY_BUTTON-->
  <!--BEGIN INTERACTIVE_TOC-->
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js">
  </script>
  <script type="text/javascript">
    DoxygenAwesomeInteractiveToc.init()
  </script>
  <!--END INTERACTIVE_TOC-->
</head>
<body>
    <div id="top">
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo">
                <img alt="Logo" src="LogoIcon.svg" />
              </td>
              <td id="projectalign">
                <div id="projectname">
                  StormRuler
                  <span id="projectnumber">&#160;0.1</span>
                </div>
                <div id="projectbrief">
                  A very high order FVM framework
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_mesh_unstructured_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">MeshUnstructured.hpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright (C) 2020-2023 Oleg Butakov</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Permission is hereby granted, free of charge, to any person obtaining a copy</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// of this software and associated documentation files (the &quot;Software&quot;), to</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// deal in the Software without restriction, including without limitation the</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// sell copies of the Software, and to permit persons to whom the Software is</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// furnished to do so, subject to the following conditions:</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">//</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// The above copyright notice and this permission notice shall be included in</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">// all copies or substantial portions of the Software.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">//</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">// SOFTWARE.</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;Storm/Base.hpp&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;Storm/Utils/Index.hpp&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;Storm/Utils/IndexedContainers.hpp&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;Storm/Utils/Meta.hpp&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;Storm/Utils/Permutations.hpp&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;Storm/Utils/Table.hpp&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;Storm/Bittern/AABB.hpp&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;Storm/Bittern/Mat.hpp&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;Storm/Mallard/Mesh.hpp&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;Storm/Mallard/Shape.hpp&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;ranges&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_storm.html">Storm</a> {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="comment"></span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment">/// @brief Hybrid unstructured multidimensional mesh.</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment">/// @tparam Dim Spatial dimensionality.</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment">/// @tparam TopologicalDim Topological dimensionality.</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment">/// @tparam Table Connectivity table class.</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment"></span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> Dim, <span class="keywordtype">size_t</span> TopologicalDim = Dim,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>         <span class="keyword">template</span>&lt;<span class="keyword">class</span>, <span class="keyword">class</span>&gt; <span class="keyword">class </span>Table = CsrTable&gt;</div>
<div class="foldopen" id="foldopen00055" data-start="{" data-end="};">
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html">   55</a></span><span class="keyword">class </span><a class="code hl_class" href="class_storm_1_1_unstructured_mesh.html">UnstructuredMesh</a> final :</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keyword">public</span> <a class="code hl_class" href="class_storm_1_1_mesh_interface.html">MeshInterface</a>&lt;UnstructuredMesh&lt;Dim, TopologicalDim, Table&gt;&gt; {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <span class="keyword">static_assert</span>(2 &lt;= TopologicalDim &amp;&amp; TopologicalDim &lt;= Dim &amp;&amp; Dim &lt;= 3);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span>, <span class="keywordtype">size_t</span>, <span class="keyword">template</span>&lt;<span class="keyword">class</span>, <span class="keyword">class</span>&gt; <span class="keyword">class</span>&gt;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code hl_class" href="class_storm_1_1_unstructured_mesh.html">UnstructuredMesh</a>;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment"></span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">  /// @brief Spatial vector type.</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a76d6cdb25c16bd50d3366b04272abf7e">   66</a></span><span class="comment"></span>  <span class="keyword">using </span><a class="code hl_class" href="class_storm_1_1_static_matrix.html">Vec</a> = <a class="code hl_class" href="class_storm_1_1_static_matrix.html">Storm::Vec&lt;real_t, Dim&gt;</a>;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment"></span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment">  /// @brief Spatial vector type.</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a93316c028ae1173ae60cc1690986f05a">   69</a></span><span class="comment"></span>  <span class="keyword">using </span><a class="code hl_class" href="class_storm_1_1_static_matrix.html">Mat</a> = <a class="code hl_class" href="class_storm_1_1_static_matrix.html">Storm::Mat&lt;real_t, Dim, Dim&gt;</a>;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment"></span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment">  /// @brief Face index type.</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">   72</a></span><span class="comment"></span>  <span class="keyword">using </span><a class="code hl_class" href="class_storm_1_1_index.html">FaceIndex</a> = <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex</a>&lt;TopologicalDim - 1&gt;;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment"></span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">  /// @brief Cell index type.</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a7e4f74f4dc404f9f4ffc83b70b2f5d3a">   75</a></span><span class="comment"></span>  <span class="keyword">using </span><a class="code hl_class" href="class_storm_1_1_index.html">CellIndex</a> = <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;TopologicalDim&gt;</a>;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  <span class="keyword">using </span>_EntityIndices = meta::make_seq_t&lt;EntityIndex, 0, TopologicalDim + 1&gt;;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  meta::as_std_tuple_t&lt;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    meta::transform_t&lt;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      <a class="code hl_struct" href="struct_storm_1_1meta_1_1pair__cast__fn.html">meta::pair_cast_fn&lt;IndexedVector&gt;</a>,</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>      meta::pair_list_t&lt;Label, _EntityIndices&gt;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    &gt;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  &gt; _entity_ranges_tuple{};</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  meta::as_std_tuple_t&lt;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    meta::prepend_t&lt;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>      <a class="code hl_struct" href="struct_storm_1_1meta_1_1empty__t.html">meta::empty_t</a>,</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>      meta::transform_t&lt;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <a class="code hl_struct" href="struct_storm_1_1meta_1_1pair__cast__fn.html">meta::pair_cast_fn&lt;IndexedVector&gt;</a>,</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        meta::pair_list_t&lt;meta::drop_first_t&lt;_EntityIndices&gt;, shapes::Type&gt;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>      &gt;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    &gt;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  &gt; _entity_shape_types_tuple{};</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  meta::as_std_tuple_t&lt;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    meta::prepend_t&lt;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      meta::empty_t,</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>      meta::transform_t&lt;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        meta::pair_cast_fn&lt;IndexedVector&gt;,</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        meta::pair_list_t&lt;meta::drop_first_t&lt;_EntityIndices&gt;, <a class="code hl_typedef" href="namespace_storm.html#a30e69333d30193d5248834bbe6aa1d6e">real_t</a>&gt;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>      &gt;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    &gt;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  &gt; _entity_volumes_tuple{};</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  meta::as_std_tuple_t&lt;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    meta::transform_t&lt;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>      meta::pair_cast_fn&lt;IndexedVector&gt;,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      meta::pair_list_t&lt;_EntityIndices, Vec&gt;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    &gt;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  &gt; _entity_positions_tuple{};</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  <span class="comment">// You don&#39;t belong here, huh?</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>  IndexedVector&lt;FaceIndex, Vec&gt; _face_normals{};</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  AABB&lt;Vec&gt; _aabb{};</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  meta::as_std_tuple_t&lt;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    meta::transform_t&lt;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>      meta::pair_cast_fn&lt;Table&gt;,</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>      meta::cartesian_product_t&lt;_EntityIndices, _EntityIndices&gt;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    &gt;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  &gt; _connectivity_tuple{};</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span><span class="comment"></span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span><span class="comment">  /// @brief Construct the mesh.</span></div>
<div class="foldopen" id="foldopen00134" data-start="{" data-end="}">
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a81ca8fe0ab06571431bd688addd7744b">  134</a></span><span class="comment"></span>  <span class="keyword">constexpr</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a81ca8fe0ab06571431bd688addd7744b">UnstructuredMesh</a>() {</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="comment">// Initialize the default label.</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    meta::for_each&lt;_EntityIndices&gt;(</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        [&amp;]&lt;<span class="keywordtype">size_t</span> I&gt;(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt;) { insert_label&lt;I&gt;(); });</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  }</div>
</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="comment"></span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="comment">  /// @brief Number of entity labels.</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00142" data-start="{" data-end="}">
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a31ba3bd460113cdc1fd3590d0bcc1d6d">  142</a></span>  <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a31ba3bd460113cdc1fd3590d0bcc1d6d">num_labels</a>(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="keywordflow">return</span> std::get&lt;I&gt;(_entity_ranges_tuple).size() - 1;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  }</div>
</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="comment"></span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="comment">  /// @brief Label range.</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00148" data-start="{" data-end="}">
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">  148</a></span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="keywordflow">return</span> std::views::iota(<a class="code hl_class" href="class_storm_1_1_index.html">Label</a>{0}, <a class="code hl_typedef" href="namespace_storm.html#acac0ee8f13dae2b90feb721b7778d75e">Label</a>{entity_ranges.size() - 1});</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  }</div>
</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment"></span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="comment">  /// @brief Number of entities.</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span></div>
<div class="foldopen" id="foldopen00156" data-start="{" data-end="}">
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a12a009f19be4178621eba712a33bbee5">  156</a></span>  <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a12a009f19be4178621eba712a33bbee5">num_entities</a>(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::get&lt;I&gt;(_entity_ranges_tuple).back());</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  }<span class="comment"></span></div>
</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span><span class="comment">  /// @brief Number of entities with label @p label.</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span></div>
<div class="foldopen" id="foldopen00162" data-start="{" data-end="}">
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a5d7a3eb0f524ef5bb7c469fc164d9d0d">  162</a></span>  <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a5d7a3eb0f524ef5bb7c469fc164d9d0d">num_entities</a>(<a class="code hl_class" href="class_storm_1_1_index.html">Label</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>, <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    STORM_ASSERT(<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a> &lt; num_labels&lt;I&gt;(), <span class="stringliteral">&quot;Label is out of range!&quot;</span>);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="keywordflow">return</span> entity_ranges[<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a> + 1] - entity_ranges[<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>];</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  }</div>
</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="comment"></span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span><span class="comment">  /// @brief Index range of the entitites.</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00170" data-start="{" data-end="}">
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#ad9ba3115c3f901d09bb2d68bdc28c523">  170</a></span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ad9ba3115c3f901d09bb2d68bdc28c523">entities</a>(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <span class="keywordflow">return</span> std::views::iota(entity_ranges.front(), entity_ranges.back());</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  }<span class="comment"></span></div>
</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="comment">  /// @brief Index range of the entitites with label @p label.</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00176" data-start="{" data-end="}">
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#aa55b955132ce5089beda5f453501bba2">  176</a></span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#aa55b955132ce5089beda5f453501bba2">entities</a>(<a class="code hl_class" href="class_storm_1_1_index.html">Label</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                          <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    STORM_ASSERT(<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a> &lt; num_labels&lt;I&gt;(), <span class="stringliteral">&quot;Label is out of range!&quot;</span>);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <span class="keywordflow">return</span> std::views::iota(entity_ranges[<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>], entity_ranges[<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a> + 1]);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  }</div>
</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="comment"></span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="comment">  /// @brief Label of the entitity at @p index.</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00185" data-start="{" data-end="}">
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">  185</a></span>  <span class="keyword">constexpr</span> <a class="code hl_class" href="class_storm_1_1_index.html">Label</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>(<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    STORM_ASSERT(<a class="code hl_concept" href="concept_storm_1_1index.html">index</a> &lt; num_entities&lt;I&gt;(), <span class="stringliteral">&quot;Entity index is out of range!&quot;</span>);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="comment">// Binary search for entity in the label ranges.</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keyword">const</span> <span class="keyword">auto</span> lower_bound = std::ranges::lower_bound(entity_ranges, <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_storm_1_1_index.html">Label</a>{lower_bound - entity_ranges.begin() - 1};</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  }</div>
</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="comment"></span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment">  /// @brief Shape type of the entitity at @p index.</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00195" data-start="{" data-end="}">
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a47f8c313f343fb54d19427d365d32b9d">  195</a></span>  <span class="keyword">constexpr</span> shapes::Type <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a47f8c313f343fb54d19427d365d32b9d">shape_type</a>(<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    STORM_ASSERT(<a class="code hl_concept" href="concept_storm_1_1index.html">index</a> &lt; num_entities&lt;I&gt;(), <span class="stringliteral">&quot;Entity index is out of range!&quot;</span>);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="keywordflow">return</span> std::get&lt;I&gt;(_entity_shape_types_tuple)[<a class="code hl_concept" href="concept_storm_1_1index.html">index</a>];</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  }</div>
</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="comment"></span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment">  /// @brief &quot;Volume&quot; of the entitity at @p index.</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00202" data-start="{" data-end="}">
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a8ad626736a2fa99984eedb9c11c9d634">  202</a></span>  <span class="keyword">constexpr</span> <a class="code hl_typedef" href="namespace_storm.html#a30e69333d30193d5248834bbe6aa1d6e">real_t</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a8ad626736a2fa99984eedb9c11c9d634">volume</a>(<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    STORM_ASSERT(<a class="code hl_concept" href="concept_storm_1_1index.html">index</a> &lt; num_entities&lt;I&gt;(), <span class="stringliteral">&quot;Entity index is out of range!&quot;</span>);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="keywordflow">return</span> std::get&lt;I&gt;(_entity_volumes_tuple)[<a class="code hl_concept" href="concept_storm_1_1index.html">index</a>];</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  }</div>
</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span><span class="comment"></span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span><span class="comment">  /// @brief Position of the entitity at @p index.</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00209" data-start="{" data-end="}">
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a028956f69857b26a9202bc9a710ed6f4">  209</a></span>  <span class="keyword">constexpr</span> <a class="code hl_class" href="class_storm_1_1_static_matrix.html">Vec</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a028956f69857b26a9202bc9a710ed6f4">position</a>(<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    STORM_ASSERT(<a class="code hl_concept" href="concept_storm_1_1index.html">index</a> &lt; num_entities&lt;I&gt;(), <span class="stringliteral">&quot;Entity index is out of range!&quot;</span>);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">return</span> std::get&lt;I&gt;(_entity_positions_tuple)[<a class="code hl_concept" href="concept_storm_1_1index.html">index</a>];</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  }</div>
</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span><span class="comment"></span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span><span class="comment">  /// @brief Normal to the face at @p face_index.</span></div>
<div class="foldopen" id="foldopen00215" data-start="{" data-end="}">
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a12439951781a8bf39027e52da12a8a1b">  215</a></span><span class="comment"></span>  <span class="keyword">constexpr</span> <a class="code hl_class" href="class_storm_1_1_static_matrix.html">Vec</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a12439951781a8bf39027e52da12a8a1b">normal</a>(<a class="code hl_class" href="class_storm_1_1_index.html">FaceIndex</a> face_index) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    STORM_ASSERT(face_index &lt; <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a12a009f19be4178621eba712a33bbee5">num_entities</a>(meta::type_v&lt;FaceIndex&gt;),</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                 <span class="stringliteral">&quot;Face index is out of range!&quot;</span>);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordflow">return</span> _face_normals[face_index];</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  }</div>
</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment"></span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="comment">  /// @brief Mesh AABB.</span></div>
<div class="foldopen" id="foldopen00222" data-start="{" data-end="}">
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a9b1db6be1032c9cc30f12850fc2a8903">  222</a></span><span class="comment"></span>  <span class="keyword">constexpr</span> <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a9b1db6be1032c9cc30f12850fc2a8903">aabb</a>() const noexcept {</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="keywordflow">return</span> _aabb;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  }</div>
</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span><span class="comment"></span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span><span class="comment">  /// @brief Range of adjacent entity indices of dim J of an entity at @p index.</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> J, <span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00228" data-start="{" data-end="}">
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a8caddd75dbfecfe8d1c1f52c2db82f02">  228</a></span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a8caddd75dbfecfe8d1c1f52c2db82f02">adjacent</a>(<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                          <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt; = {}) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    STORM_ASSERT(<a class="code hl_concept" href="concept_storm_1_1index.html">index</a> &lt; num_entities&lt;I&gt;(), <span class="stringliteral">&quot;Entity index is out of range!&quot;</span>);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="keywordflow">return</span> std::get&lt;T&gt;(_connectivity_tuple)[<a class="code hl_concept" href="concept_storm_1_1index.html">index</a>];</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  }</div>
</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="comment"></span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="comment">  /// @brief Find an entity by it&#39;s @p node_indices. Complexity is constant.</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I, std::ranges::input_range Range&gt;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="keyword">requires</span> (I != 0) &amp;&amp;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>             std::same_as&lt;std::ranges::range_value_t&lt;Range&gt;, <a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a>&gt;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="keyword">constexpr</span> std::optional&lt;EntityIndex&lt;I&gt;&gt;</div>
<div class="foldopen" id="foldopen00240" data-start="{" data-end="}">
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a19bc3c03be4537aa85c689538c4bad4b">  240</a></span>  <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a19bc3c03be4537aa85c689538c4bad4b">find</a>(Range&amp;&amp; node_indices, <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) <span class="keyword">const</span> {</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// Select the entities that are adjacent to the first node in the list.</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="keyword">auto</span> adj = adjacent&lt;I&gt;(node_indices.front());</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    STORM_CPP23_THREAD_LOCAL std::vector&lt;EntityIndex&lt;I&gt;&gt; found{};</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    found.assign(adj.begin(), adj.end());</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    std::ranges::sort(found);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="comment">// For the other node indices, select the adjacent enitites,</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="comment">// and intersect with the recently found.</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    STORM_CPP23_THREAD_LOCAL std::vector&lt;EntityIndex&lt;I&gt;&gt; temp{}, update{};</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a> node_index : node_indices | std::views::drop(1)) {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>      <span class="keywordflow">if</span> (found.empty()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>      adj = adjacent&lt;I&gt;(node_index);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      temp.assign(adj.begin(), adj.end());</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      std::ranges::sort(temp);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>      std::ranges::set_intersection(found, temp, std::back_inserter(update));</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      found.swap(update), update.clear();</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    }</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="comment">// Return the result.</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keywordflow">switch</span> (found.size()) {</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> found.front();</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    }</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    STORM_THROW(<span class="stringliteral">&quot;For the specified node list more than one entity found!&quot;</span>);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  }</div>
</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="comment"></span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="comment">  /// @brief Copy-assign the unstructured @p mesh with different table type.</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keyword">template</span>&lt;<span class="keyword">class</span>, <span class="keyword">class</span>&gt; <span class="keyword">class </span>OtherTable&gt;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00270" data-start="{" data-end="}">
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#adb942b9db28d0ceb7efe9f6d89d2a6c3">  270</a></span>  <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#adb942b9db28d0ceb7efe9f6d89d2a6c3">assign</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_storm_1_1_unstructured_mesh.html">UnstructuredMesh&lt;Dim, TopologicalDim, OtherTable&gt;</a>&amp; <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="comment">// Copy the ranges and shape properties.</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    _entity_ranges_tuple = <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_ranges_tuple;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    _entity_shape_types_tuple = <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_shape_types_tuple;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    _entity_volumes_tuple = <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_volumes_tuple;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    _entity_positions_tuple = <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_positions_tuple;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    _face_normals = <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._face_normals;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    _aabb = <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._aabb;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="comment">// Copy the connectivity tables.</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> I&gt;(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt;) {</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="keyword">using </span>U = OtherTable&lt;EntityIndex&lt;I&gt;, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        std::get&lt;T&gt;(_connectivity_tuple)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            .assign(std::get&lt;U&gt;(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._connectivity_tuple));</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>      });</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    });</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  }</div>
</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment"></span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">  /// @brief Move-assign the unstructured @p mesh with different table type.</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keyword">template</span>&lt;<span class="keyword">class</span>, <span class="keyword">class</span>&gt; <span class="keyword">class </span>OtherTable&gt;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00293" data-start="{" data-end="}">
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a8328cd7a2789e9bbcdf60875bad2fbf2">  293</a></span>  <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a8328cd7a2789e9bbcdf60875bad2fbf2">assign</a>(<a class="code hl_class" href="class_storm_1_1_unstructured_mesh.html">UnstructuredMesh&lt;Dim, TopologicalDim, OtherTable&gt;</a>&amp;&amp; <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="comment">// Move the ranges and shape properties.</span><span class="comment"></span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="comment">    /// @todo Ranges of the source mesh would be invalid.</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment"></span>    _entity_ranges_tuple = std::move(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_ranges_tuple);</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    _entity_shape_types_tuple = std::move(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_shape_types_tuple);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    _entity_volumes_tuple = std::move(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_volumes_tuple);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    _entity_positions_tuple = std::move(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._entity_positions_tuple);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    _face_normals = std::move(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._face_normals);</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    _aabb = std::move(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._aabb);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="comment">// Move the connectivity tables.</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> I&gt;(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt;) {</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;) {</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="keyword">using </span>U = OtherTable&lt;EntityIndex&lt;I&gt;, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;J&gt;</a>&gt;;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        std::get&lt;T&gt;(_connectivity_tuple)</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            .assign(std::move(std::get&lt;U&gt;(<a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>._connectivity_tuple)));</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      });</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    });</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  }</div>
</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="comment"></span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="comment">  /// @brief Assign the arbitrary @p mesh.</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment"></span>  <span class="keyword">template</span>&lt;mesh Mesh&gt;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#add65e64dfafa656cc5f0e4f6e13830ea">  316</a></span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#add65e64dfafa656cc5f0e4f6e13830ea">assign</a>(<span class="keyword">const</span> Mesh&amp; <a class="code hl_concept" href="concept_storm_1_1mesh.html">mesh</a>); <span class="comment">// not implemented yet!</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment"></span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="comment">  /// @brief Reverve memory for the entities.</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00320" data-start="{" data-end="}">
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#aac75209e2d50ee3e4826b18b30d03c4e">  320</a></span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#aac75209e2d50ee3e4826b18b30d03c4e">reserve</a>(<span class="keywordtype">size_t</span> capacity, <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    std::get&lt;I&gt;(_entity_positions_tuple).reserve(capacity);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (!std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_class" href="class_storm_1_1_index.html">NodeIndex</a>&gt;) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      std::get&lt;I&gt;(_entity_shape_types_tuple).reserve(capacity);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>      std::get&lt;I&gt;(_entity_volumes_tuple).reserve(capacity);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    }</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">FaceIndex</a>&gt;) {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>      _face_normals.reserve(capacity);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(meta::type&lt;EntityIndex&lt;J&gt;&gt;) {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, EntityIndex&lt;J&gt;&gt;;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>      std::get&lt;T&gt;(_connectivity_tuple).reserve(capacity);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    });</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  }</div>
</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="comment"></span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span><span class="comment">  /// @brief Insert a new entity label.</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I&gt;</div>
<div class="foldopen" id="foldopen00337" data-start="{" data-end="}">
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a07fee517ed93bbc17ac586f37e6695da">  337</a></span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a07fee517ed93bbc17ac586f37e6695da">insert_label</a>(<a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <span class="keywordflow">if</span> (entity_ranges.empty()) {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      entity_ranges.reserve(2);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>      entity_ranges.emplace_back(0), entity_ranges.emplace_back(0);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      entity_ranges.push_back(entity_ranges.back());</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    }</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>  }</div>
</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="comment"></span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="comment">  /// @brief Insert a new entity of shape @p shape.</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment">  /// The last existing entity label will be assigned to it.</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">  /// @returns Index of the entity.</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I, <span class="keyword">class</span> Shape&gt;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="keyword">requires</span> ((I == 0 &amp;&amp; std::constructible_from&lt;Vec, Shape&gt;) ||</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>              (shapes::shape&lt;Shape&gt; &amp;&amp; I == shapes::shape_dim_v&lt;Shape&gt;) )</div>
<div class="foldopen" id="foldopen00353" data-start="{" data-end="}">
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a86e3df17d63bbc90011d08816906a68a">  353</a></span>  <span class="keyword">constexpr</span> <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a86e3df17d63bbc90011d08816906a68a">insert</a>(Shape&amp;&amp; shape,</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>                                  <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="comment">// Allocate the entity index,</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="comment">// implicitly assigning the last existing label label.</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>{std::get&lt;I&gt;(_entity_ranges_tuple).back()++};</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="comment">// Assign the geometrical properties.</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a>&gt;) {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="comment">// Assign the node position and update the AABB.</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <span class="keyword">auto</span>&amp; node_positions = std::get&lt;I&gt;(_entity_positions_tuple);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="class_storm_1_1_unstructured_mesh.html#a76d6cdb25c16bd50d3366b04272abf7e">Vec</a>&amp; <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a028956f69857b26a9202bc9a710ed6f4">position</a> = node_positions.emplace_back(shape);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      <span class="keywordflow">if</span> (node_positions.size() == 1) {</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        _aabb = AABB{<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a028956f69857b26a9202bc9a710ed6f4">position</a>};</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        _aabb.extend(<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a028956f69857b26a9202bc9a710ed6f4">position</a>);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>      <span class="comment">// Assign the entity shape type, volume, center position (and normal).</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      std::get&lt;I&gt;(_entity_shape_types_tuple).emplace_back(shape.type());</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>      std::get&lt;I&gt;(_entity_volumes_tuple)</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>          .emplace_back(shapes::volume(shape, *<span class="keyword">this</span>));</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      std::get&lt;I&gt;(_entity_positions_tuple)</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>          .emplace_back(shapes::barycenter(shape, *<span class="keyword">this</span>));</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>      <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">FaceIndex</a>&gt;) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (Dim == TopologicalDim) {</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>          _face_normals.emplace_back(shapes::normal(shape, *<span class="keyword">this</span>));</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        } <span class="keywordflow">else</span> {<span class="comment"></span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="comment">          /// @todo What are the face normals for surface meshes?</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="comment"></span>          _face_normals.emplace_back({});</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>      }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <span class="comment">// Assign the connectivity properties.</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(meta::type&lt;EntityIndex&lt;J&gt;&gt;) {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>      <span class="comment">// Allocate the empty rows.</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, EntityIndex&lt;J&gt;&gt;;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      std::get&lt;T&gt;(_connectivity_tuple).push_back();</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    });</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (!std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a>&gt;) {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      <span class="comment">// Connnect the entity with it&#39;s nodes.</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>      <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a>&gt;;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>      <span class="keyword">using </span>U = Table&lt;NodeIndex, EntityIndex&lt;I&gt;&gt;;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a> node_index : shape.<a class="code hl_function" href="class_storm_1_1_mesh_interface.html#a1f8049b90e3cbee04e5fadda184d5725">nodes</a>()) {</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        std::get&lt;T&gt;(_connectivity_tuple).insert(index, node_index);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        std::get&lt;U&gt;(_connectivity_tuple).insert(node_index, index);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>      }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    }</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    meta::for_each&lt;meta::make_seq_t&lt;EntityIndex, 1, I&gt;&gt;(</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        [&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(meta::type&lt;EntityIndex&lt;J&gt;&gt;) {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>          <span class="comment">// Connect the entity with it&#39;s parts (possibly creating them).</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>          <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, EntityIndex&lt;J&gt;&gt;;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>          <span class="keyword">using </span>U = Table&lt;EntityIndex&lt;J&gt;, EntityIndex&lt;I&gt;&gt;;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>          <span class="keyword">const</span> <span class="keyword">auto</span> process_part = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; part) {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>            <span class="keyword">const</span> EntityIndex&lt;J&gt; part_index = find_or_insert&lt;J&gt;(part);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>            std::get&lt;T&gt;(_connectivity_tuple).insert(index, part_index);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>            std::get&lt;U&gt;(_connectivity_tuple).insert(part_index, index);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            <span class="comment">// Fix the face orientation (if needed).</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;EntityIndex&lt;J&gt;, <a class="code hl_typedef" href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">FaceIndex</a>&gt;) {</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>              _update_face_orientation(part_index, part.nodes());</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            }</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>          };</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>          std::apply([&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp;... parts) { (process_part(parts), ...); },</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                     shapes::parts&lt;J&gt;(shape));</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        });</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <span class="comment">// Connect the entity with it&#39;s siblings.</span><span class="comment"></span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span><span class="comment">    /// @todo Implement me!</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span><span class="comment"></span>    <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, EntityIndex&lt;I&gt;&gt;;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    std::get&lt;T&gt;(_connectivity_tuple).insert(index, index);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="keywordflow">return</span> index;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  }</div>
</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span><span class="comment"></span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span><span class="comment">  /// @brief Find an existing entity of shape @p shape or insert a new one.</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span><span class="comment">  /// @returns Index of the entity.</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I, shapes::shape Shape&gt;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keyword">requires</span> (I == shapes::shape_dim_v&lt;Shape&gt;)</div>
<div class="foldopen" id="foldopen00431" data-start="{" data-end="}">
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a772d73d25a86c1bc30323c7983b8918b">  431</a></span>  <span class="keyword">constexpr</span> <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a772d73d25a86c1bc30323c7983b8918b">find_or_insert</a>(Shape&amp;&amp; shape,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                                          <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a> = find&lt;I&gt;(shape.nodes()); <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>.has_value()) {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>      <span class="keywordflow">return</span> *<a class="code hl_concept" href="concept_storm_1_1index.html">index</a>;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keywordflow">return</span> insert&lt;I&gt;(std::forward&lt;Shape&gt;(shape));</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  }</div>
</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span><span class="comment"></span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span><span class="comment">  /// @brief Permute the entities. Complexity is log²-linear.</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span><span class="comment">  /// @param perm Entity permutation range, it may be modified in order to</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="comment">  ///             preserve the label ranges correctness.</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="comment">  /// @warning Permutation range values will be spoiled after the call!</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I, std::ranges::sized_range Range&gt;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="keyword">requires</span> std::ranges::random_access_range&lt;Range&gt; &amp;&amp;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>             std::permutable&lt;std::ranges::iterator_t&lt;Range&gt;&gt; &amp;&amp;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>             std::same_as&lt;std::ranges::range_value_t&lt;Range&gt;, EntityIndex&lt;I&gt;&gt;</div>
<div class="foldopen" id="foldopen00447" data-start="{" data-end="}">
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a72cee4a811edee03637b868cb0332cf4">  447</a></span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a72cee4a811edee03637b868cb0332cf4">permute</a>(Range&amp;&amp; perm, <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) {</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    STORM_ASSERT(std::ranges::size(perm) == num_entities&lt;I&gt;(),</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>                 <span class="stringliteral">&quot;Invalid permutation size!&quot;</span>);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="comment">// Stable-sort the permutation in order to keep the label ranges correct.</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    std::ranges::stable_sort(</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        perm, [&amp;](<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> index_1, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> index_2) {</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>          <span class="keywordflow">return</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>(index_1) &lt; <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>(index_2);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        });</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="comment">// Permute the entities.</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    _permute_base(perm);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  }</div>
</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="comment"></span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span><span class="comment">  /// @brief Assign the entity labels. Complexity is log²-linear.</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="comment">  /// @param label Labels range to assign. May be smaller,</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment">  ///              than the amount of entities.</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I, std::ranges::sized_range Range&gt;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <span class="keyword">requires</span> std::ranges::random_access_range&lt;Range&gt; &amp;&amp;</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>             std::same_as&lt;std::ranges::range_value_t&lt;Range&gt;, <a class="code hl_typedef" href="namespace_storm.html#acac0ee8f13dae2b90feb721b7778d75e">Label</a>&gt;</div>
<div class="foldopen" id="foldopen00467" data-start="{" data-end="}">
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno"><a class="line" href="class_storm_1_1_unstructured_mesh.html#a05c6134f51dd0e61ef9a367004cfaacc">  467</a></span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a05c6134f51dd0e61ef9a367004cfaacc">assign_labels</a>(Range&amp;&amp; <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>,</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>                               <a class="code hl_struct" href="struct_storm_1_1meta_1_1type.html">meta::type</a>&lt;<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a>&gt; = {}) {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    STORM_ASSERT(std::ranges::size(<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>) &lt;= num_entities&lt;I&gt;(),</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>                 <span class="stringliteral">&quot;Invalid labels range size!&quot;</span>);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <span class="comment">// Permute the entities according to labels.</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    std::vector&lt;EntityIndex&lt;I&gt;&gt; perm(num_entities&lt;I&gt;());</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    std::ranges::copy(entities&lt;I&gt;(), perm.begin());</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    std::ranges::stable_sort(</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        perm, [&amp;](<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> index_1, <a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> index_2) {</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>          <span class="keyword">const</span> <span class="keyword">auto</span> new_label = [&amp;](<a class="code hl_class" href="class_storm_1_1_index.html">EntityIndex&lt;I&gt;</a> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a>) {</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>            <span class="keyword">const</span> <span class="keyword">auto</span> index_sz = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_concept" href="concept_storm_1_1index.html">index</a>);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="keywordflow">return</span> <a class="code hl_concept" href="concept_storm_1_1index.html">index</a> &gt;= <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>.size() ? <a class="code hl_class" href="class_storm_1_1_index.html">Label</a>{0} : <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>[index_sz];</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>          };</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>          <span class="keywordflow">return</span> new_label(index_1) &lt; new_label(index_2);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        });</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    _permute_base&lt;I&gt;(perm);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="comment">// Generate the new label ranges.</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> delta = this-&gt;num_entities&lt;I&gt;() - std::ranges::size(<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    <span class="keyword">auto</span>&amp; entity_ranges = std::get&lt;I&gt;(_entity_ranges_tuple);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    entity_ranges.clear();</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_storm.html#acac0ee8f13dae2b90feb721b7778d75e">Label</a> <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a> : <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">labels</a>) {</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>      entity_ranges.resize(std::max(entity_ranges.size(), <span class="comment">//</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                                    <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a>) + 2));</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>      entity_ranges[<a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">label</a> + 1] += 1;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    };</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    entity_ranges[<a class="code hl_typedef" href="namespace_storm.html#acac0ee8f13dae2b90feb721b7778d75e">Label</a>{0} + 1] += delta;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    std::partial_sum(entity_ranges.begin(), entity_ranges.end(),</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                     entity_ranges.begin(),</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>                     [](EntityIndex&lt;I&gt; index_1, EntityIndex&lt;I&gt; index_2) {</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                       return index_1 + static_cast&lt;size_t&gt;(index_2);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>                     });</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  }</div>
</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>  <span class="comment">// Update the face orientation such that if it has a single adjacent cell,</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="comment">// than the cell is inner.</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  <span class="keyword">template</span>&lt;std::ranges::forward_range Range&gt;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="keyword">requires</span> std::ranges::sized_range&lt;Range&gt; &amp;&amp;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>             std::same_as&lt;std::ranges::range_value_t&lt;Range&gt;, <a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a>&gt;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> _update_face_orientation(<a class="code hl_typedef" href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">FaceIndex</a> face_index,</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                                          Range&amp;&amp; cell_face_nodes) {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <span class="comment">// Detect the face orientation.</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <span class="keyword">const</span> <span class="keyword">auto</span> face_nodes = adjacent&lt;0&gt;(face_index);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <span class="keywordtype">bool</span> cell_is_inner, cell_is_outer;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_cell_faces = std::ranges::size(cell_face_nodes);</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    STORM_ASSERT(num_cell_faces &gt;= 2, <span class="stringliteral">&quot;This function should be called in 1D!&quot;</span>);</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    <span class="keywordflow">if</span> (num_cell_faces == 2) {</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>      cell_is_inner = std::ranges::equal(cell_face_nodes, face_nodes);</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>      cell_is_outer =</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>          std::ranges::equal(cell_face_nodes, face_nodes | std::views::reverse);</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>      <span class="comment">// Need to take into the account possible rotations.</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      STORM_CPP23_THREAD_LOCAL std::vector&lt;NodeIndex&gt; temp{};</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      temp.assign(cell_face_nodes.begin(), cell_face_nodes.end());</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>      std::ranges::rotate(temp, std::ranges::find(temp, face_nodes.front()));</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      cell_is_inner = std::ranges::equal(temp, face_nodes);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>      cell_is_outer = !cell_is_inner &amp;&amp; [&amp;] {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        std::ranges::rotate(temp, std::ranges::find(temp, face_nodes.back()));</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        <span class="keywordflow">return</span> std::ranges::equal(temp, face_nodes | std::views::reverse);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>      }();</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    <span class="comment">// Check and update the orientation (if needed).</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <span class="keyword">const</span> <span class="keyword">auto</span> cell_faces = adjacent&lt;TopologicalDim&gt;(face_index);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <span class="keywordflow">if</span> (cell_faces.size() == 1) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>      STORM_ENSURE(cell_is_inner || cell_is_outer,</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                   <span class="stringliteral">&quot;Face has a single adjacent cell, &quot;</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                   <span class="stringliteral">&quot;but it can be neither inner nor outer!&quot;</span>);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>      <span class="comment">// Flip the face if the cell is outer.</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>      <span class="keywordflow">if</span> (cell_is_outer) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        _face_normals[face_index] = -_face_normals[face_index];</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        meta::for_each&lt;meta::make_seq_t&lt;<a class="code hl_typedef" href="namespace_storm.html#aac04112f24f6bd48f7bb3586d93be3dd">EntityIndex</a>, 0, TopologicalDim - 1&gt;&gt;(</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>            [&amp;]&lt;<span class="keywordtype">size_t</span> I&gt;(meta::type&lt;EntityIndex&lt;I&gt;&gt;) {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>              <span class="keyword">using </span>T = Table&lt;FaceIndex, EntityIndex&lt;I&gt;&gt;;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>              std::ranges::reverse(</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>                  std::get&lt;T&gt;(_connectivity_tuple)[face_index]);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>            });</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      }</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cell_faces.size() == 2) {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      STORM_ENSURE(cell_is_outer,</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                   <span class="stringliteral">&quot;Face has two adjacent cells, &quot;</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>                   <span class="stringliteral">&quot;but the second cell cannot be the outer one!&quot;</span>);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      STORM_ABORT(<span class="stringliteral">&quot;Invalid number of the face cells!&quot;</span>);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    }</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="comment">// Actually permute the entities.</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> I, std::ranges::random_access_range Range&gt;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <span class="keyword">requires</span> std::permutable&lt;std::ranges::iterator_t&lt;Range&gt;&gt; &amp;&amp;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>             std::same_as&lt;std::ranges::range_value_t&lt;Range&gt;, EntityIndex&lt;I&gt;&gt;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  <span class="keyword">constexpr</span> <span class="keywordtype">void</span> _permute_base(Range&amp;&amp; perm, meta::type&lt;EntityIndex&lt;I&gt;&gt; = {}) {</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    { <span class="comment">// Update the connectivity with inverse permutations.</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>      IndexedVector&lt;EntityIndex&lt;I&gt;, EntityIndex&lt;I&gt;&gt; iperm(num_entities&lt;I&gt;());</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>      <a class="code hl_function" href="namespace_storm_1_1permutations.html#a60c3a577325a95338196165f499b2593">permutations::invert_permutation</a>(perm, iperm.begin());</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>      meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(meta::type&lt;EntityIndex&lt;J&gt;&gt;) {</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <span class="keywordflow">for</span> (EntityIndex&lt;J&gt; index : <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ad9ba3115c3f901d09bb2d68bdc28c523">entities</a>&lt;J&gt;()) {</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>          <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;J&gt;, EntityIndex&lt;I&gt;&gt;;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>          <span class="keyword">decltype</span>(<span class="keyword">auto</span>) adj = std::get&lt;T&gt;(_connectivity_tuple)[index];</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>          <span class="keywordflow">for</span> (EntityIndex&lt;I&gt;&amp; adjacent_index : adj) {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>            adjacent_index = iperm[adjacent_index];</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>          }</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>      });</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    }</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="comment">// Permute the entity-* connectivity.</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    meta::for_each&lt;_EntityIndices&gt;([&amp;]&lt;<span class="keywordtype">size_t</span> J&gt;(meta::type&lt;EntityIndex&lt;J&gt;&gt;) {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <span class="keyword">using </span>T = Table&lt;EntityIndex&lt;I&gt;, EntityIndex&lt;J&gt;&gt;;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <span class="keyword">auto</span>&amp; table = std::get&lt;T&gt;(_connectivity_tuple);</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>      T permuted_table{};</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>      permuted_table.reserve(num_entities&lt;I&gt;());</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>      <span class="keywordflow">for</span> (EntityIndex&lt;I&gt; index : <a class="code hl_function" href="class_storm_1_1_unstructured_mesh.html#ad9ba3115c3f901d09bb2d68bdc28c523">entities</a>&lt;I&gt;()) {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="keyword">const</span> <span class="keyword">auto</span> index_sz = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(index);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        <span class="keyword">const</span> EntityIndex&lt;I&gt; permuted_index = perm[index_sz];</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        permuted_table.push_back(std::move(table[permuted_index]));</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>      }</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      table = std::move(permuted_table);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    });</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    <span class="comment">// Permute the entity shape properties.</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    <a class="code hl_function" href="namespace_storm_1_1permutations.html#a048aaac87f02dfd5c198f62a67c2e61f">permutations::permute_inplace</a>(</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        perm, [&amp;](EntityIndex&lt;I&gt; index_1, EntityIndex&lt;I&gt; index_2) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>          <span class="keyword">const</span> <span class="keyword">auto</span> gather_shape_properties = [&amp;](EntityIndex&lt;I&gt; index) {</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            <span class="keyword">auto</span>&amp; positions = std::get&lt;I&gt;(_entity_positions_tuple);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">NodeIndex</a>&gt;) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>              <span class="keywordflow">return</span> std::tie(positions[index]);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>              <span class="keyword">auto</span>&amp; shape_types = std::get&lt;I&gt;(_entity_shape_types_tuple);</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>              <span class="keyword">auto</span>&amp; volumes = std::get&lt;I&gt;(_entity_volumes_tuple);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>              <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;EntityIndex&lt;I&gt;, <a class="code hl_typedef" href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">FaceIndex</a>&gt;) {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>                <span class="keywordflow">return</span> std::tie(shape_types[index], volumes[index],</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                                positions[index], _face_normals[index]);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>              } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>                <span class="keywordflow">return</span> std::tie(shape_types[index], volumes[index],</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                                positions[index]);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>              }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>            }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>          };</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>          <span class="keyword">auto</span> properties_1 = gather_shape_properties(index_1);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>          <span class="keyword">auto</span> properties_2 = gather_shape_properties(index_2);</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>          std::swap(properties_1, properties_2);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        });</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>  }</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>}; <span class="comment">// class UnstructuredMesh</span></div>
</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>} <span class="comment">// namespace Storm</span></div>
<div class="ttc" id="aclass_storm_1_1_index_html"><div class="ttname"><a href="class_storm_1_1_index.html">Storm::Index</a></div><div class="ttdoc">Strictly-tagged index.</div><div class="ttdef"><b>Definition</b> <a href="_index_8hpp_source.html#l00038">Index.hpp:38</a></div></div>
<div class="ttc" id="aclass_storm_1_1_mesh_interface_html"><div class="ttname"><a href="class_storm_1_1_mesh_interface.html">Storm::MeshInterface</a></div><div class="ttdoc">CRTP interface to a mesh.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00332">Mesh.hpp:332</a></div></div>
<div class="ttc" id="aclass_storm_1_1_mesh_interface_html_a1f8049b90e3cbee04e5fadda184d5725"><div class="ttname"><a href="class_storm_1_1_mesh_interface.html#a1f8049b90e3cbee04e5fadda184d5725">Storm::MeshInterface::nodes</a></div><div class="ttdeci">constexpr auto nodes() const noexcept</div><div class="ttdoc">Range of the nodes.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00399">Mesh.hpp:399</a></div></div>
<div class="ttc" id="aclass_storm_1_1_static_matrix_html"><div class="ttname"><a href="class_storm_1_1_static_matrix.html">Storm::StaticMatrix</a></div><div class="ttdoc">Statically-sized matrix.</div><div class="ttdef"><b>Definition</b> <a href="_mat_8hpp_source.html#l00036">Mat.hpp:37</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html">Storm::UnstructuredMesh</a></div><div class="ttdoc">Hybrid unstructured multidimensional mesh.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00055">MeshUnstructured.hpp:56</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a028956f69857b26a9202bc9a710ed6f4"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a028956f69857b26a9202bc9a710ed6f4">Storm::UnstructuredMesh::position</a></div><div class="ttdeci">constexpr Vec position(EntityIndex&lt; I &gt; index) const noexcept</div><div class="ttdoc">Position of the entitity at index.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00209">MeshUnstructured.hpp:209</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a05c6134f51dd0e61ef9a367004cfaacc"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a05c6134f51dd0e61ef9a367004cfaacc">Storm::UnstructuredMesh::assign_labels</a></div><div class="ttdeci">constexpr void assign_labels(Range &amp;&amp;labels, meta::type&lt; EntityIndex&lt; I &gt; &gt;={})</div><div class="ttdoc">Assign the entity labels. Complexity is log²-linear.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00467">MeshUnstructured.hpp:467</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a07fee517ed93bbc17ac586f37e6695da"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a07fee517ed93bbc17ac586f37e6695da">Storm::UnstructuredMesh::insert_label</a></div><div class="ttdeci">constexpr void insert_label(meta::type&lt; EntityIndex&lt; I &gt; &gt;={})</div><div class="ttdoc">Insert a new entity label.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00337">MeshUnstructured.hpp:337</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a12439951781a8bf39027e52da12a8a1b"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a12439951781a8bf39027e52da12a8a1b">Storm::UnstructuredMesh::normal</a></div><div class="ttdeci">constexpr Vec normal(FaceIndex face_index) const noexcept</div><div class="ttdoc">Normal to the face at face_index.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00215">MeshUnstructured.hpp:215</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a12a009f19be4178621eba712a33bbee5"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a12a009f19be4178621eba712a33bbee5">Storm::UnstructuredMesh::num_entities</a></div><div class="ttdeci">constexpr size_t num_entities(meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const noexcept</div><div class="ttdoc">Number of entities.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00156">MeshUnstructured.hpp:156</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a19bc3c03be4537aa85c689538c4bad4b"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a19bc3c03be4537aa85c689538c4bad4b">Storm::UnstructuredMesh::find</a></div><div class="ttdeci">constexpr std::optional&lt; EntityIndex&lt; I &gt; &gt; find(Range &amp;&amp;node_indices, meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const</div><div class="ttdoc">Find an entity by it's node_indices. Complexity is constant.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00240">MeshUnstructured.hpp:240</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a2b7a3c5f38dbc8581aa65f99ac6b7d81"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a2b7a3c5f38dbc8581aa65f99ac6b7d81">Storm::UnstructuredMesh::labels</a></div><div class="ttdeci">constexpr auto labels(meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const noexcept</div><div class="ttdoc">Label range.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00148">MeshUnstructured.hpp:148</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a31ba3bd460113cdc1fd3590d0bcc1d6d"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a31ba3bd460113cdc1fd3590d0bcc1d6d">Storm::UnstructuredMesh::num_labels</a></div><div class="ttdeci">constexpr size_t num_labels(meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const noexcept</div><div class="ttdoc">Number of entity labels.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00142">MeshUnstructured.hpp:142</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a47f8c313f343fb54d19427d365d32b9d"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a47f8c313f343fb54d19427d365d32b9d">Storm::UnstructuredMesh::shape_type</a></div><div class="ttdeci">constexpr shapes::Type shape_type(EntityIndex&lt; I &gt; index) const noexcept</div><div class="ttdoc">Shape type of the entitity at index.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00195">MeshUnstructured.hpp:195</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a5d7a3eb0f524ef5bb7c469fc164d9d0d"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a5d7a3eb0f524ef5bb7c469fc164d9d0d">Storm::UnstructuredMesh::num_entities</a></div><div class="ttdeci">constexpr size_t num_entities(Label label, meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const noexcept</div><div class="ttdoc">Number of entities with label label.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00162">MeshUnstructured.hpp:162</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a72cee4a811edee03637b868cb0332cf4"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a72cee4a811edee03637b868cb0332cf4">Storm::UnstructuredMesh::permute</a></div><div class="ttdeci">constexpr void permute(Range &amp;&amp;perm, meta::type&lt; EntityIndex&lt; I &gt; &gt;={})</div><div class="ttdoc">Permute the entities. Complexity is log²-linear.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00447">MeshUnstructured.hpp:447</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a76d6cdb25c16bd50d3366b04272abf7e"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a76d6cdb25c16bd50d3366b04272abf7e">Storm::UnstructuredMesh::Vec</a></div><div class="ttdeci">Storm::Vec&lt; real_t, Dim &gt; Vec</div><div class="ttdoc">Spatial vector type.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00066">MeshUnstructured.hpp:66</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a772d73d25a86c1bc30323c7983b8918b"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a772d73d25a86c1bc30323c7983b8918b">Storm::UnstructuredMesh::find_or_insert</a></div><div class="ttdeci">constexpr EntityIndex&lt; I &gt; find_or_insert(Shape &amp;&amp;shape, meta::type&lt; EntityIndex&lt; I &gt; &gt;={})</div><div class="ttdoc">Find an existing entity of shape shape or insert a new one.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00431">MeshUnstructured.hpp:431</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a81ca8fe0ab06571431bd688addd7744b"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a81ca8fe0ab06571431bd688addd7744b">Storm::UnstructuredMesh::UnstructuredMesh</a></div><div class="ttdeci">constexpr UnstructuredMesh()</div><div class="ttdoc">Construct the mesh.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00134">MeshUnstructured.hpp:134</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a8328cd7a2789e9bbcdf60875bad2fbf2"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a8328cd7a2789e9bbcdf60875bad2fbf2">Storm::UnstructuredMesh::assign</a></div><div class="ttdeci">constexpr void assign(UnstructuredMesh&lt; Dim, TopologicalDim, OtherTable &gt; &amp;&amp;mesh)</div><div class="ttdoc">Move-assign the unstructured mesh with different table type.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00293">MeshUnstructured.hpp:293</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a86e3df17d63bbc90011d08816906a68a"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a86e3df17d63bbc90011d08816906a68a">Storm::UnstructuredMesh::insert</a></div><div class="ttdeci">constexpr EntityIndex&lt; I &gt; insert(Shape &amp;&amp;shape, meta::type&lt; EntityIndex&lt; I &gt; &gt;={})</div><div class="ttdoc">Insert a new entity of shape shape. The last existing entity label will be assigned to it.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00353">MeshUnstructured.hpp:353</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a8ad626736a2fa99984eedb9c11c9d634"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a8ad626736a2fa99984eedb9c11c9d634">Storm::UnstructuredMesh::volume</a></div><div class="ttdeci">constexpr real_t volume(EntityIndex&lt; I &gt; index) const noexcept</div><div class="ttdoc">&quot;Volume&quot; of the entitity at index.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00202">MeshUnstructured.hpp:202</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a8caddd75dbfecfe8d1c1f52c2db82f02"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a8caddd75dbfecfe8d1c1f52c2db82f02">Storm::UnstructuredMesh::adjacent</a></div><div class="ttdeci">constexpr auto adjacent(EntityIndex&lt; I &gt; index, meta::type&lt; EntityIndex&lt; J &gt; &gt;={}) const noexcept</div><div class="ttdoc">Range of adjacent entity indices of dim J of an entity at index.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00228">MeshUnstructured.hpp:228</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_a9b1db6be1032c9cc30f12850fc2a8903"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#a9b1db6be1032c9cc30f12850fc2a8903">Storm::UnstructuredMesh::aabb</a></div><div class="ttdeci">constexpr const auto &amp; aabb() const noexcept</div><div class="ttdoc">Mesh AABB.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00222">MeshUnstructured.hpp:222</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_aa55b955132ce5089beda5f453501bba2"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#aa55b955132ce5089beda5f453501bba2">Storm::UnstructuredMesh::entities</a></div><div class="ttdeci">constexpr auto entities(Label label, meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const noexcept</div><div class="ttdoc">Index range of the entitites with label label.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00176">MeshUnstructured.hpp:176</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_aac75209e2d50ee3e4826b18b30d03c4e"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#aac75209e2d50ee3e4826b18b30d03c4e">Storm::UnstructuredMesh::reserve</a></div><div class="ttdeci">constexpr void reserve(size_t capacity, meta::type&lt; EntityIndex&lt; I &gt; &gt;={})</div><div class="ttdoc">Reverve memory for the entities.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00320">MeshUnstructured.hpp:320</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_ab2efb7745a36b9a393e8125b8964d751"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#ab2efb7745a36b9a393e8125b8964d751">Storm::UnstructuredMesh::label</a></div><div class="ttdeci">constexpr Label label(EntityIndex&lt; I &gt; index) const noexcept</div><div class="ttdoc">Label of the entitity at index.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00185">MeshUnstructured.hpp:185</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_ac60a99a9dd6663377c0d3ea591408ee0"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#ac60a99a9dd6663377c0d3ea591408ee0">Storm::UnstructuredMesh::FaceIndex</a></div><div class="ttdeci">EntityIndex&lt; TopologicalDim - 1 &gt; FaceIndex</div><div class="ttdoc">Face index type.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00072">MeshUnstructured.hpp:72</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_ad9ba3115c3f901d09bb2d68bdc28c523"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#ad9ba3115c3f901d09bb2d68bdc28c523">Storm::UnstructuredMesh::entities</a></div><div class="ttdeci">constexpr auto entities(meta::type&lt; EntityIndex&lt; I &gt; &gt;={}) const noexcept</div><div class="ttdoc">Index range of the entitites.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00170">MeshUnstructured.hpp:170</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_adb942b9db28d0ceb7efe9f6d89d2a6c3"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#adb942b9db28d0ceb7efe9f6d89d2a6c3">Storm::UnstructuredMesh::assign</a></div><div class="ttdeci">constexpr void assign(const UnstructuredMesh&lt; Dim, TopologicalDim, OtherTable &gt; &amp;mesh)</div><div class="ttdoc">Copy-assign the unstructured mesh with different table type.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_unstructured_8hpp_source.html#l00270">MeshUnstructured.hpp:270</a></div></div>
<div class="ttc" id="aclass_storm_1_1_unstructured_mesh_html_add65e64dfafa656cc5f0e4f6e13830ea"><div class="ttname"><a href="class_storm_1_1_unstructured_mesh.html#add65e64dfafa656cc5f0e4f6e13830ea">Storm::UnstructuredMesh::assign</a></div><div class="ttdeci">constexpr void assign(const Mesh &amp;mesh)</div><div class="ttdoc">Assign the arbitrary mesh.</div></div>
<div class="ttc" id="aconcept_storm_1_1index_html"><div class="ttname"><a href="concept_storm_1_1index.html">Storm::index</a></div><div class="ttdoc">Index type.</div><div class="ttdef"><b>Definition</b> <a href="_index_8hpp_source.html#l00145">Index.hpp:145</a></div></div>
<div class="ttc" id="aconcept_storm_1_1mesh_html"><div class="ttname"><a href="concept_storm_1_1mesh.html">Storm::mesh</a></div><div class="ttdoc">Mesh concept.</div><div class="ttdef"><b>Definition</b> <a href="_fwd_8hpp_source.html#l00048">Fwd.hpp:48</a></div></div>
<div class="ttc" id="anamespace_storm_1_1permutations_html_a048aaac87f02dfd5c198f62a67c2e61f"><div class="ttname"><a href="namespace_storm_1_1permutations.html#a048aaac87f02dfd5c198f62a67c2e61f">Storm::permutations::permute_inplace</a></div><div class="ttdeci">constexpr void permute_inplace(PermutationIterator perm_iterator, PermutationSentinel perm_sentinel, SwapFunc swap_func)</div><div class="ttdoc">Apply the permutation inplace. Complexity is linear.</div><div class="ttdef"><b>Definition</b> <a href="_permutations_8hpp_source.html#l00089">Permutations.hpp:89</a></div></div>
<div class="ttc" id="anamespace_storm_1_1permutations_html_a60c3a577325a95338196165f499b2593"><div class="ttname"><a href="namespace_storm_1_1permutations.html#a60c3a577325a95338196165f499b2593">Storm::permutations::invert_permutation</a></div><div class="ttdeci">constexpr void invert_permutation(PermutationIterator perm_iterator, PermutationSentinel perm_sentinel, InversePermutationIterator iperm_iterator)</div><div class="ttdoc">Invert the permutation. Complexity is linear.</div><div class="ttdef"><b>Definition</b> <a href="_permutations_8hpp_source.html#l00059">Permutations.hpp:59</a></div></div>
<div class="ttc" id="anamespace_storm_html"><div class="ttname"><a href="namespace_storm.html">Storm</a></div><div class="ttdef"><b>Definition</b> <a href="_base_8hpp_source.html#l00032">Base.hpp:32</a></div></div>
<div class="ttc" id="anamespace_storm_html_a30e69333d30193d5248834bbe6aa1d6e"><div class="ttname"><a href="namespace_storm.html#a30e69333d30193d5248834bbe6aa1d6e">Storm::real_t</a></div><div class="ttdeci">double real_t</div><div class="ttdoc">Real floating-point type.</div><div class="ttdef"><b>Definition</b> <a href="_types_8hpp_source.html#l00038">Types.hpp:38</a></div></div>
<div class="ttc" id="anamespace_storm_html_a57306979ec22263c3d55c274a5d22218"><div class="ttname"><a href="namespace_storm.html#a57306979ec22263c3d55c274a5d22218">Storm::NodeIndex</a></div><div class="ttdeci">EntityIndex&lt; 0 &gt; NodeIndex</div><div class="ttdoc">Node index type.</div><div class="ttdef"><b>Definition</b> <a href="_fwd_8hpp_source.html#l00065">Fwd.hpp:65</a></div></div>
<div class="ttc" id="anamespace_storm_html_aac04112f24f6bd48f7bb3586d93be3dd"><div class="ttname"><a href="namespace_storm.html#aac04112f24f6bd48f7bb3586d93be3dd">Storm::EntityIndex</a></div><div class="ttdeci">Index&lt; TopologicalIndexTag&lt; I &gt; &gt; EntityIndex</div><div class="ttdoc">Topological index type.</div><div class="ttdef"><b>Definition</b> <a href="_fwd_8hpp_source.html#l00062">Fwd.hpp:62</a></div></div>
<div class="ttc" id="anamespace_storm_html_acac0ee8f13dae2b90feb721b7778d75e"><div class="ttname"><a href="namespace_storm.html#acac0ee8f13dae2b90feb721b7778d75e">Storm::Label</a></div><div class="ttdeci">Index&lt; LabelTag &gt; Label</div><div class="ttdoc">Label index type.</div><div class="ttdef"><b>Definition</b> <a href="_fwd_8hpp_source.html#l00055">Fwd.hpp:55</a></div></div>
<div class="ttc" id="astruct_storm_1_1meta_1_1empty__t_html"><div class="ttname"><a href="struct_storm_1_1meta_1_1empty__t.html">Storm::meta::empty_t</a></div><div class="ttdef"><b>Definition</b> <a href="_meta_8hpp_source.html#l00042">Meta.hpp:42</a></div></div>
<div class="ttc" id="astruct_storm_1_1meta_1_1pair__cast__fn_html"><div class="ttname"><a href="struct_storm_1_1meta_1_1pair__cast__fn.html">Storm::meta::pair_cast_fn</a></div><div class="ttdef"><b>Definition</b> <a href="_meta_8hpp_source.html#l00386">Meta.hpp:386</a></div></div>
<div class="ttc" id="astruct_storm_1_1meta_1_1type_html"><div class="ttname"><a href="struct_storm_1_1meta_1_1type.html">Storm::meta::type</a></div><div class="ttdef"><b>Definition</b> <a href="_meta_8hpp_source.html#l00053">Meta.hpp:53</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!--
  Copyright (C) 2020-2023 Oleg Butakov
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
-->
<!-- HTML footer for doxygen 1.9.5-->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_15c6cbc4c866d40eee351c12f4fbd2b7.html">Storm</a></li><li class="navelem"><a class="el" href="dir_a3c24bddb6ad69bbc91b40b040b85608.html">Mallard</a></li><li class="navelem"><b>MeshUnstructured.hpp</b></li>
    <li class="footer">
      Generated by
      <a href="https://www.doxygen.org/index.html">
        Doxygen
      </a>
      1.9.8
    </li>
  </ul>
</div>
</body>
</html>
